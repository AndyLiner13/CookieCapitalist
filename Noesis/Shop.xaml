<!-- 
  Shop - Upgrade shop page (Screen Overlay)
  Display Mode: Screen Overlay, Render Order: 5
  Input Mode: Interactive, nonblocking
  Visibility controlled by TypeScript based on current page
-->

<Page
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  mc:Ignorable="d"
  d:DataContext="Shop_DataSet"
  d:DesignWidth="393"
  d:DesignHeight="852">

<Page.Resources>
  <ResourceDictionary>
    <BooleanToVisibilityConverter x:Key="BoolToVis"/>
    
    <!-- Invisible button style -->
    <Style x:Key="InvisibleButtonStyle" TargetType="Button">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="BorderBrush" Value="Transparent"/>
      <Setter Property="Padding" Value="0"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>
  </ResourceDictionary>
</Page.Resources>

<Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Transparent"
      Visibility="{Binding isVisible, Converter={StaticResource BoolToVis}}">
  
  <Grid.RowDefinitions>
    <RowDefinition Height="143"/>  <!-- Header spacer -->
    <RowDefinition Height="*"/>     <!-- Content area -->
    <RowDefinition Height="124"/>   <!-- Footer spacer -->
  </Grid.RowDefinitions>
  
  <!-- Shop Content Area -->
  <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
    <StackPanel Orientation="Vertical" Margin="16,8">
      
      <!-- Shop Title -->
      <TextBlock Text="UPGRADES" FontFamily="Fonts/#Anton" FontSize="24" Foreground="#FFFFFF" 
                 HorizontalAlignment="Center" Margin="0,0,0,16"/>
      
      <!-- Upgrade Items List -->
      <ItemsControl ItemsSource="{Binding upgrades}">
        <ItemsControl.ItemTemplate>
          <DataTemplate>
            <Border Background="#40000000" CornerRadius="12" Margin="0,0,0,12" Padding="12">
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="64"/>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Upgrade Icon -->
                <Image Grid.Column="0" Source="{Binding image}" Width="48" Height="48" 
                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                
                <!-- Upgrade Info -->
                <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="8,0">
                  <TextBlock Text="{Binding name}" FontFamily="Fonts/#Anton" FontSize="18" Foreground="#FFFFFF"/>
                  <TextBlock Text="{Binding rate}" FontFamily="Fonts/#Roboto" FontSize="12" Foreground="#AAAAAA"/>
                  <TextBlock FontFamily="Fonts/#Roboto" FontSize="12" Foreground="#FFDD00">
                    <Run Text="Owned: "/><Run Text="{Binding owned}"/>
                  </TextBlock>
                </StackPanel>
                
                <!-- Buy Button -->
                <Button Grid.Column="2" Style="{StaticResource InvisibleButtonStyle}" 
                        Command="{Binding buyCommand}" VerticalAlignment="Center"
                        RenderTransformOrigin="0.5,0.5">
                  <Button.RenderTransform>
                    <ScaleTransform x:Name="BuyBtnScale" ScaleX="1" ScaleY="1"/>
                  </Button.RenderTransform>
                  <b:Interaction.Triggers>
                    <b:EventTrigger EventName="PreviewMouseLeftButtonDown">
                      <b:ControlStoryboardAction>
                        <b:ControlStoryboardAction.Storyboard>
                          <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="BuyBtnScale" Storyboard.TargetProperty="ScaleX" To="0.9" Duration="0:0:0.05"/>
                            <DoubleAnimation Storyboard.TargetName="BuyBtnScale" Storyboard.TargetProperty="ScaleY" To="0.9" Duration="0:0:0.05"/>
                          </Storyboard>
                        </b:ControlStoryboardAction.Storyboard>
                      </b:ControlStoryboardAction>
                    </b:EventTrigger>
                    <b:EventTrigger EventName="PreviewMouseLeftButtonUp">
                      <b:ControlStoryboardAction>
                        <b:ControlStoryboardAction.Storyboard>
                          <Storyboard>
                            <DoubleAnimation Storyboard.TargetName="BuyBtnScale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.15">
                              <DoubleAnimation.EasingFunction><QuadraticEase EasingMode="EaseOut"/></DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                            <DoubleAnimation Storyboard.TargetName="BuyBtnScale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.15">
                              <DoubleAnimation.EasingFunction><QuadraticEase EasingMode="EaseOut"/></DoubleAnimation.EasingFunction>
                            </DoubleAnimation>
                          </Storyboard>
                        </b:ControlStoryboardAction.Storyboard>
                      </b:ControlStoryboardAction>
                    </b:EventTrigger>
                  </b:Interaction.Triggers>
                  <Border Background="{Binding canAfford, Converter={StaticResource BoolToVis}}" 
                          CornerRadius="8" Padding="12,8">
                    <Border.Style>
                      <Style TargetType="Border">
                        <Setter Property="Background" Value="#22AA22"/>
                        <Style.Triggers>
                          <DataTrigger Binding="{Binding canAfford}" Value="False">
                            <Setter Property="Background" Value="#666666"/>
                          </DataTrigger>
                        </Style.Triggers>
                      </Style>
                    </Border.Style>
                    <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                      <TextBlock Text="{Binding buyLabel}" FontFamily="Fonts/#Anton" FontSize="14" 
                                 Foreground="#FFFFFF" HorizontalAlignment="Center"/>
                      <TextBlock Text="{Binding price}" FontFamily="Fonts/#Roboto" FontSize="11" 
                                 Foreground="#DDDDDD" HorizontalAlignment="Center"/>
                    </StackPanel>
                  </Border>
                </Button>
              </Grid>
            </Border>
          </DataTemplate>
        </ItemsControl.ItemTemplate>
      </ItemsControl>
      
    </StackPanel>
  </ScrollViewer>

</Grid>
</Page>

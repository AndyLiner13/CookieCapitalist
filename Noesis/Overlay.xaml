<!-- 
  Overlay - Header and Navigation combined (Screen Overlay)
  Display Mode: Screen Overlay, Render Order: 10 (top layer)
  Input Mode: Interactive, nonblocking
  Contains: Cookie count/CPS header at top, navigation tabs at bottom
  NOTE: Main Grid is hit-test invisible, only header/footer borders capture clicks
  
  RESPONSIVE: Uses percentage-based row heights and scalable font sizes
-->

<Page
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  mc:Ignorable="d"
  d:DataContext="Overlay_DataSet"
  d:DesignWidth="393"
  d:DesignHeight="852" xmlns:noesis="clr-namespace:NoesisGUIExtensions">

<Page.Resources>
  <ResourceDictionary>
    <BooleanToVisibilityConverter x:Key="BoolToVis"/>
    
    <!-- Invisible button style - no hover/click visual feedback -->
    <Style x:Key="InvisibleButtonStyle" TargetType="Button">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderThickness" Value="0"/>
      <Setter Property="BorderBrush" Value="Transparent"/>
      <Setter Property="Padding" Value="0"/>
      <Setter Property="Template">
        <Setter.Value>
          <ControlTemplate TargetType="Button">
            <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
          </ControlTemplate>
        </Setter.Value>
      </Setter>
    </Style>
  </ResourceDictionary>
</Page.Resources>

<!-- Main container - null background so clicks pass through empty areas -->
<Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="{x:Null}" ClipToBounds="False">

  <Grid.RowDefinitions>
    <!-- Header: fixed 140px for consistent notch clearance -->
    <RowDefinition Height="140"/>
    <!-- Multiplier area -->
    <RowDefinition Height="Auto"/>
    <!-- Middle spacer -->
    <RowDefinition Height="*"/>
    <!-- Footer: fixed 124px for navigation buttons -->
    <RowDefinition Height="124"/>
  </Grid.RowDefinitions>

  <!-- ═════════════════════════════════════════════════════════════════════════════════════════ -->
  <!-- Region: Header - Cookie Count (Shared across all pages)                                  -->
  <!-- ═════════════════════════════════════════════════════════════════════════════════════════ -->
  <Button HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Grid.Row="0" 
          HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"
          Style="{StaticResource InvisibleButtonStyle}" Command="{Binding onHeaderClick}">
    <b:Interaction.Triggers>
      <!-- Reset focused interaction when mouse/touch starts in header -->
      <b:EventTrigger EventName="PreviewMouseLeftButtonDown">
        <b:InvokeCommandAction Command="{Binding onHeaderClick}"/>
      </b:EventTrigger>
      <!-- Also reset when mouse/touch is released in header (supports drag from cookie into header) -->
      <b:EventTrigger EventName="PreviewMouseLeftButtonUp">
        <b:InvokeCommandAction Command="{Binding onHeaderClick}"/>
      </b:EventTrigger>
    </b:Interaction.Triggers>
    <Border HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="#80000000" Padding="16,54,16,16" ClipToBounds="False">
      <StackPanel Orientation="Vertical" HorizontalAlignment="Center" VerticalAlignment="Center" ClipToBounds="False">
        <!-- Cookie count -->
        <TextBlock Text="{Binding cookieCount}" FontFamily="Fonts/#Anton-Regular" FontSize="36" Foreground="#ffffff" TextAlignment="Center" ClipToBounds="False"/>
        <!-- CPS display -->
        <TextBlock Text="{Binding cookiesPerSecond}" FontFamily="Fonts/#Anton-Regular" FontSize="18" Foreground="#ffffff" TextAlignment="Center" Margin="0,0,0,0" ClipToBounds="False"/>
      </StackPanel>
    </Border>
  </Button>

  <!-- ═════════════════════════════════════════════════════════════════════════════════════════ -->
  <!-- Region: Multiplier Display (shows above cookie when active)                              -->
  <!-- ═════════════════════════════════════════════════════════════════════════════════════════ -->
  <Border Grid.Row="1" Background="{x:Null}" Padding="0,28,0,0" HorizontalAlignment="Center" Width="300"
          Visibility="{Binding multiplierVisible, Converter={StaticResource BoolToVis}}" IsHitTestVisible="False" ClipToBounds="False">
    <!-- Container for blink animation - opacity applied here, not on TextBlock -->
    <Border Background="{x:Null}" Opacity="{Binding multiplierOpacity}" IsHitTestVisible="False">
      <TextBlock x:Name="MultiplierText"
                 Text="{Binding multiplierText}" 
                 FontFamily="Fonts/#Bangers-Regular" 
                 FontSize="64" 
                 Foreground="#FFD700" 
                 TextAlignment="Center"
                 HorizontalAlignment="Center"
                 RenderTransformOrigin="0.5,0.5"
                 Width="200"
                 ClipToBounds="False"
                 IsHitTestVisible="False">
        <TextBlock.RenderTransform>
          <TransformGroup>
            <TranslateTransform x:Name="MultiplierShake" X="{Binding shakeX}" Y="{Binding shakeY}"/>
            <ScaleTransform x:Name="MultiplierScale" ScaleX="{Binding multiplierScale}" ScaleY="{Binding multiplierScale}"/>
          </TransformGroup>
        </TextBlock.RenderTransform>
        <TextBlock.Effect>
          <DropShadowEffect Color="#000000" BlurRadius="0" ShadowDepth="4" Opacity="1" Direction="315"/>
        </TextBlock.Effect>
      </TextBlock>
    </Border>
  </Border>

  <!-- ═════════════════════════════════════════════════════════════════════════════════════════ -->
  <!-- Region: Middle Area - Empty (clicks pass through to CoreGame cookie)                     -->
  <!-- ═════════════════════════════════════════════════════════════════════════════════════════ -->

  <!-- ═════════════════════════════════════════════════════════════════════════════════════════ -->
  <!-- Region: Footer - Navigation Tabs                                                         -->
  <!-- ═════════════════════════════════════════════════════════════════════════════════════════ -->
  <Border HorizontalAlignment="Stretch" Background="#01000000" Grid.Row="3" IsHitTestVisible="True">
    <Grid HorizontalAlignment="Center" VerticalAlignment="Center" Margin="16">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="24"/>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="24"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>
      
      <!-- Left Tab (Shop) - behavior mirrors shop buy buttons -->
      <Button Grid.Column="0" Style="{StaticResource InvisibleButtonStyle}" VerticalAlignment="Center" RenderTransformOrigin="0.5,0.5" Command="{Binding onShopClick}">
        <Button.RenderTransform>
          <ScaleTransform x:Name="LeftTabScale" ScaleX="1" ScaleY="1"/>
        </Button.RenderTransform>
        <b:Interaction.Triggers>
          <b:EventTrigger EventName="PreviewMouseLeftButtonDown">
            <b:ControlStoryboardAction>
              <b:ControlStoryboardAction.Storyboard>
                <Storyboard>
                  <DoubleAnimation Storyboard.TargetName="LeftTabScale" Storyboard.TargetProperty="ScaleX" To="0.9" Duration="0:0:0.05"/>
                  <DoubleAnimation Storyboard.TargetName="LeftTabScale" Storyboard.TargetProperty="ScaleY" To="0.9" Duration="0:0:0.05"/>
                </Storyboard>
              </b:ControlStoryboardAction.Storyboard>
            </b:ControlStoryboardAction>
          </b:EventTrigger>
          <b:EventTrigger EventName="PreviewMouseLeftButtonUp">
            <b:ControlStoryboardAction>
              <b:ControlStoryboardAction.Storyboard>
                <Storyboard>
                  <DoubleAnimation Storyboard.TargetName="LeftTabScale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.1">
                    <DoubleAnimation.EasingFunction>
                      <QuadraticEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                  </DoubleAnimation>
                  <DoubleAnimation Storyboard.TargetName="LeftTabScale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.1">
                    <DoubleAnimation.EasingFunction>
                      <QuadraticEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                  </DoubleAnimation>
                </Storyboard>
              </b:ControlStoryboardAction.Storyboard>
            </b:ControlStoryboardAction>
          </b:EventTrigger>
          <b:EventTrigger EventName="MouseLeave">
            <b:ControlStoryboardAction>
              <b:ControlStoryboardAction.Storyboard>
                <Storyboard>
                  <DoubleAnimation Storyboard.TargetName="LeftTabScale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.1"/>
                  <DoubleAnimation Storyboard.TargetName="LeftTabScale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.1"/>
                </Storyboard>
              </b:ControlStoryboardAction.Storyboard>
            </b:ControlStoryboardAction>
          </b:EventTrigger>
        </b:Interaction.Triggers>
        <Image Source="Images/LeftTab.png" Width="93" Height="92" Stretch="Uniform"/>
      </Button>
      
      <!-- Middle Tab (Home) - behavior mirrors shop buy buttons -->
      <Button Grid.Column="2" Style="{StaticResource InvisibleButtonStyle}" VerticalAlignment="Center" RenderTransformOrigin="0.5,0.5" Command="{Binding onHomeClick}">
        <Button.RenderTransform>
          <ScaleTransform x:Name="MiddleTabScale" ScaleX="1" ScaleY="1"/>
        </Button.RenderTransform>
        <b:Interaction.Triggers>
          <b:EventTrigger EventName="PreviewMouseLeftButtonDown">
            <b:ControlStoryboardAction>
              <b:ControlStoryboardAction.Storyboard>
                <Storyboard>
                  <DoubleAnimation Storyboard.TargetName="MiddleTabScale" Storyboard.TargetProperty="ScaleX" To="0.9" Duration="0:0:0.05"/>
                  <DoubleAnimation Storyboard.TargetName="MiddleTabScale" Storyboard.TargetProperty="ScaleY" To="0.9" Duration="0:0:0.05"/>
                </Storyboard>
              </b:ControlStoryboardAction.Storyboard>
            </b:ControlStoryboardAction>
          </b:EventTrigger>
          <b:EventTrigger EventName="PreviewMouseLeftButtonUp">
            <b:ControlStoryboardAction>
              <b:ControlStoryboardAction.Storyboard>
                <Storyboard>
                  <DoubleAnimation Storyboard.TargetName="MiddleTabScale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.1">
                    <DoubleAnimation.EasingFunction>
                      <QuadraticEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                  </DoubleAnimation>
                  <DoubleAnimation Storyboard.TargetName="MiddleTabScale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.1">
                    <DoubleAnimation.EasingFunction>
                      <QuadraticEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                  </DoubleAnimation>
                </Storyboard>
              </b:ControlStoryboardAction.Storyboard>
            </b:ControlStoryboardAction>
          </b:EventTrigger>
          <b:EventTrigger EventName="MouseLeave">
            <b:ControlStoryboardAction>
              <b:ControlStoryboardAction.Storyboard>
                <Storyboard>
                  <DoubleAnimation Storyboard.TargetName="MiddleTabScale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.1"/>
                  <DoubleAnimation Storyboard.TargetName="MiddleTabScale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.1"/>
                </Storyboard>
              </b:ControlStoryboardAction.Storyboard>
            </b:ControlStoryboardAction>
          </b:EventTrigger>
        </b:Interaction.Triggers>
        <Image Source="Images/MiddleTab.png" Width="93" Height="92" Stretch="Uniform"/>
      </Button>
      
      <!-- Right Tab (Leaderboard) - behavior mirrors shop buy buttons -->
      <Button Grid.Column="4" Style="{StaticResource InvisibleButtonStyle}" VerticalAlignment="Center" RenderTransformOrigin="0.5,0.5" Command="{Binding onLeaderboardClick}">
        <Button.RenderTransform>
          <ScaleTransform x:Name="RightTabScale" ScaleX="1" ScaleY="1"/>
        </Button.RenderTransform>
        <b:Interaction.Triggers>
          <b:EventTrigger EventName="PreviewMouseLeftButtonDown">
            <b:ControlStoryboardAction>
              <b:ControlStoryboardAction.Storyboard>
                <Storyboard>
                  <DoubleAnimation Storyboard.TargetName="RightTabScale" Storyboard.TargetProperty="ScaleX" To="0.9" Duration="0:0:0.05"/>
                  <DoubleAnimation Storyboard.TargetName="RightTabScale" Storyboard.TargetProperty="ScaleY" To="0.9" Duration="0:0:0.05"/>
                </Storyboard>
              </b:ControlStoryboardAction.Storyboard>
            </b:ControlStoryboardAction>
          </b:EventTrigger>
          <b:EventTrigger EventName="PreviewMouseLeftButtonUp">
            <b:ControlStoryboardAction>
              <b:ControlStoryboardAction.Storyboard>
                <Storyboard>
                  <DoubleAnimation Storyboard.TargetName="RightTabScale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.1">
                    <DoubleAnimation.EasingFunction>
                      <QuadraticEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                  </DoubleAnimation>
                  <DoubleAnimation Storyboard.TargetName="RightTabScale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.1">
                    <DoubleAnimation.EasingFunction>
                      <QuadraticEase EasingMode="EaseOut"/>
                    </DoubleAnimation.EasingFunction>
                  </DoubleAnimation>
                </Storyboard>
              </b:ControlStoryboardAction.Storyboard>
            </b:ControlStoryboardAction>
          </b:EventTrigger>
          <b:EventTrigger EventName="MouseLeave">
            <b:ControlStoryboardAction>
              <b:ControlStoryboardAction.Storyboard>
                <Storyboard>
                  <DoubleAnimation Storyboard.TargetName="RightTabScale" Storyboard.TargetProperty="ScaleX" To="1" Duration="0:0:0.1"/>
                  <DoubleAnimation Storyboard.TargetName="RightTabScale" Storyboard.TargetProperty="ScaleY" To="1" Duration="0:0:0.1"/>
                </Storyboard>
              </b:ControlStoryboardAction.Storyboard>
            </b:ControlStoryboardAction>
          </b:EventTrigger>
        </b:Interaction.Triggers>
        <Image Source="Images/RightTab.png" Width="93" Height="92" Stretch="Uniform"/>
      </Button>
    </Grid>
  </Border>
</Grid>
</Page>
